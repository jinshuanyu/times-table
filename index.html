<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ååä¹˜æ³•è¡¨ & ä¹˜æ³•å¤§æŒ‘æˆ°ï½œHTML5</title>

<!-- Tone.js (for sound effects) -->
<script src="https://unpkg.com/tone@14.8.49/build/Tone.js"></script>

<style>
:root{
  /* åŸºæœ¬è‰²ï¼ˆç„¡æ¼¸å±¤ï¼‰ */
  --bg:#f7f8fb; --card:#ffffff; --text:#1f2937; --muted:#6b7280; --line:#e5e7eb;

  --blue-50:#eff6ff; --blue-100:#dbeafe; --blue-200:#bfdbfe; --blue-800:#1e40af;
  --yellow-100:#fef3c7; --yellow-300:#fcd34d; --yellow-800:#92400e;

  --purple-200:#e9d5ff; --purple-300:#d8b4fe; --purple-500:#7c3aed;
  --green-200:#bbf7d0; --green-300:#86efac; --green-500:#22c55e;

  --indigo-300:#a5b4fc; --indigo-400:#818cf8; --indigo-800:#3730a3; --indigo-900:#312e81;
  --orange-200:#fed7aa; --orange-300:#fdba74; --orange-500:#f97316;
  --red-500:#ef4444; --teal-50:#f0fdfa; --teal-600:#0d9488;

  /* æ•´ç«™åº•è‰²ï¼šå¾ˆæ·¡ã€ä½å½©åº¦çš„ç²‰ç´… */
  --bg-pink:hsl(345 35% 98%);
}

*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0; background:var(--bg-pink); color:var(--text);
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", "Helvetica Neue", Arial;
}

.wrap{
  min-height:100svh; display:flex; flex-direction:column; align-items:center; justify-content:center;
  padding:16px;
}

/* ===== Top nav (å…©é¡† pill) ===== */
nav{
  margin-bottom:20px; padding:12px 16px; background:var(--card);
  border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,.06);
  display:flex; flex-wrap:wrap; justify-content:center; gap:12px;
}
.pill{
  border:0; cursor:pointer; padding:10px 18px; border-radius:999px; font-weight:800; font-size:18px;
  transition:transform .15s ease, background-color .15s ease, box-shadow .15s ease, color .15s ease;
}
.pill:hover{ transform:scale(1.05) }
.pill-purple{ background:var(--purple-200); color:#5b21b6 }
.pill-purple.active{ background:var(--purple-500); color:#fff; box-shadow:0 6px 16px rgba(124,58,237,.28) }
.pill-purple:hover{ background:var(--purple-300) }
.pill-green{ background:var(--green-200); color:#065f46 }
.pill-green.active{ background:var(--green-500); color:#fff; box-shadow:0 6px 16px rgba(34,197,94,.28) }
.pill-green:hover{ background:var(--green-300) }

/* æ‰‹æ©Ÿï¼šå°è¦½å…©é¡†åŒæ’ */
@media (max-width:480px){
  nav{
    display:grid; grid-template-columns:repeat(2, minmax(0, 1fr));
    gap:8px; justify-content:center;
  }
  .pill{ width:100%; padding:10px 12px; font-size:18px }
}

/* ===== å…§å®¹å€ ===== */
main{ width:100%; max-width:760px; padding:8px } /* æ¡Œæ©Ÿæ”¶çª„ */
section.card{ background:transparent }
h1.title{
  font-size:clamp(28px,4vw,44px); margin:0 0 16px; font-weight:900; text-align:center; color:#2563eb;
}
/* ç§»é™¤å­¸ç¿’é çš„èªªæ˜æ–‡å­— */
#learningPage .subtitle{ display:none !important; }

/* ===== Learningï¼ˆ10Ã—10 ä¹˜æ³•è¡¨ï¼‰ ===== */
.table-wrap{ overflow-x:auto }
table.mul{
  width:100%;
  border:1px solid var(--blue-200);
  border-collapse:collapse;
  background:var(--blue-50);
  border-radius:0 !important;                /* ä¸è¦åœ“è§’ */
  box-shadow:0 8px 20px rgba(30,64,175,.06);
  font-size:clamp(14px,3.8vw,18px);
  table-layout:fixed;
}
.mul th,.mul td{
  padding:7px 6px;
  border-bottom:1px solid var(--blue-200);
  text-align:center; white-space:nowrap;
}
.mul thead th{ background:var(--blue-100); color:var(--blue-800); font-weight:800 }
.mul tbody td:first-child{
  background:#eaf2ff; color:#1d4ed8; font-weight:800; position:sticky; left:0;
}
.mul td.hl, .mul th.hl { background:#fff7cc !important }
.mul td.hl-strong, .mul th.hl-strong{ background:#ffe066 !important }

/* æ¡Œæ©Ÿï¼šä¹˜æ³•è¡¨å®¹å™¨å†æ”¶çª„ä¸€é»ï¼ˆé¿å…å¤ªæ‰ï¼‰ */
@media (min-width:1024px){
  #learningPage .table-wrap{
    max-width:700px; margin-left:auto; margin-right:auto;
  }
}
/* æ‰‹æ©Ÿï¼šæ›´è²¼é‚Šï¼ˆå¹¾ä¹ç„¡ç•™ç™½ï¼‰ */
@media (max-width:480px){
  .wrap{ padding-left:12px; padding-right:12px }
  main{ padding:0 }
  #learningPage .table-wrap{ margin-left:-8px; margin-right:-8px; padding:0 2px }
}

/* ===== Practiceï¼ˆç·´ç¿’ï¼‰ ===== */
.center{ text-align:center }
.score{ font-size:clamp(18px,2.5vw,28px); font-weight:800; color:#065f46; margin-bottom:8px }
.qcount{ font-size:clamp(16px,2.3vw,24px); color:#475569; margin-bottom:18px }

.question-box{
  display:inline-block; background:var(--yellow-100); padding:22px;
  border-radius:16px; box-shadow:0 10px 24px rgba(0,0,0,.06);
  margin-bottom:18px;
}
.question{ font-size:clamp(38px,6vw,62px); font-weight:900; color:var(--yellow-800); margin:0 }

.grid{ display:grid; gap:12px; margin:0 auto }
.grid-choices{ grid-template-columns:repeat(2,minmax(0,1fr)); max-width:520px }
.grid-multipliers{ grid-template-columns:repeat(5,minmax(0,1fr)); max-width:720px; margin-bottom:8px }
#btnStart{ margin-top:10px }

.btn{
  border:0; cursor:pointer; padding:14px 16px; border-radius:14px; font-weight:900;
  transition:transform .12s ease, box-shadow .15s ease, background-color .12s ease, color .12s ease;
  box-shadow:0 4px 12px rgba(0,0,0,.06); font-size:clamp(18px,3.2vw,28px)
}
.btn:hover{ transform:scale(1.04) }

/* ç­”æ¡ˆé¸é … */
.btn-choice{ background:var(--indigo-300); color:#111827 }
.btn-choice:hover{ background:var(--indigo-400) }
.btn-choice.correct{ background:var(--green-500) !important; color:#fff !important; transform:scale(1.08) }
.btn-choice.wrong{ background:var(--red-500) !important; color:#fff !important; transform:scale(1.03) }
.btn-choice.dim{ opacity:.55; cursor:not-allowed }

/* ä¹˜æ•¸æŒ‰éˆ• */
.btn-multi{ background:var(--orange-200); color:#7c2d12; font-size:clamp(20px,3.5vw,30px) }
.btn-multi.active{ background:var(--orange-500); color:#fff; box-shadow:0 6px 14px rgba(249,115,22,.28) }
.btn-multi:hover{ background:var(--orange-300) }
.btn-multi[data-val="all"].active{
  background:var(--indigo-900) !important; color:#fff !important;
  box-shadow:0 10px 20px rgba(49,46,129,.5) !important;
  border-color:transparent !important;
}
.btn-multi[data-val="all"].active:hover{ background:var(--indigo-800) !important }

.btn-start{
  background:#3b82f6; color:#fff; padding:14px 24px; border-radius:999px; font-weight:900; font-size:clamp(20px,3.8vw,32px);
  box-shadow:0 8px 22px rgba(59,130,246,.28)
}
.btn-start:disabled{ background:#cbd5e1; color:#475569; cursor:not-allowed; box-shadow:none }

.feedback{ font-size:clamp(20px,3.2vw,32px); font-weight:900; margin-top:10px; animation:bounce 1s infinite }
@keyframes bounce{ 0%,100%{ transform:translateY(0) } 50%{ transform:translateY(-6px) } }

/* æ‰‹æ©Ÿï¼š1x~10x æ¯æ’ 3 å€‹ï¼ŒæŒ‰éˆ•æ›´å¯¬æ›´å¥½æŒ‰ */
@media (max-width: 600px){
  #practicePage .grid-multipliers{
    grid-template-columns: repeat(3, minmax(0, 1fr)) !important;
    gap: 10px !important;
    max-width: 100% !important;
  }
  #practicePage .grid-multipliers > button[data-val="all"]{
    grid-column: 1 / -1;
    margin-bottom: 6px;
  }
  #practicePage .grid-multipliers > .btn-multi{
    width: 100%;
    min-height: 54px;
    padding: 12px 8px;
    font-size: 20px;
    justify-content: center;
  }
}
/* æ‰‹æ©Ÿä¸Šé¿å…å°å°çš„ scale é€ æˆé«˜åº¦å¤–æº¢ */
@media (max-width:480px){
  .question-box{ transform:none }
}

/* ===== çµæœé ï¼ˆResultï¼‰ ===== */
.result-title{
  font-size:clamp(22px,4.4vw,28px); font-weight:900; color:var(--teal-600);
  text-align:center; margin:0 0 10px;
}
.score-badge{
  display:inline-block; font-size:clamp(28px,7vw,36px); font-weight:900; color:var(--teal-600);
  background:var(--teal-50); padding:12px 16px; border-radius:999px; box-shadow:0 8px 20px rgba(13,148,136,.18);
  margin-bottom:12px;
}
/* ã€Œä½ çš„æœ€çµ‚å¾—åˆ†æ˜¯ï¼šã€ç¸®å°ä¸€é» */
#practicePage .result-title + p{
  font-size:16px !important; margin:6px 0 8px !important;
}

/* é¡Œç›®å›é¡§æ¨™é¡Œï¼šåªç¸®çµæœé é€™å€‹ h2ï¼Œä¸å½±éŸ¿å…¶ä»– .title */
#practicePage .result-title ~ h2.title{
  font-size:18px !important; line-height:1.3;
  margin-top:8px !important; margin-bottom:8px !important;
}

/* å›é¡§å¡ç‰‡ï¼ˆæ‰‹æ©Ÿé‚Šè· 12pxã€å®‰å…¨å…§è· 12pxã€åœ“è§’ï¼‰ */
.review{
  background:var(--card); border-radius:12px; box-shadow:0 8px 20px rgba(0,0,0,.06);
  padding:16px; overflow-x:auto; margin:0 auto; max-width:none;
}
@media (max-width:480px){
  .review{
    position:relative;
    left:50%; right:50%;
    margin-left:calc(-50vw + 12px) !important;
    margin-right:calc(-50vw + 12px) !important;
    width:calc(100vw - 24px) !important;
    max-width:calc(100vw - 24px) !important;
    padding:12px !important; border-radius:12px !important;
  }
}

/* å›é¡§è¡¨æ ¼ï¼šæœ€å¤§å¯¬åº¦ 540ã€ç½®ä¸­ï¼›æ¬„å¯¬ 56/22/22ã€è¡¨é ­ 18px */
table.review-table{
  width:100% !important;
  max-width:540px !important;
  margin-left:auto !important; margin-right:auto !important;
  border-collapse:collapse;
  table-layout:auto !important;
  font-size:clamp(14px,2.5vw,16px);
}
.review-table th,.review-table td{
  padding:10px 12px; border-bottom:1px solid var(--line); text-align:left; white-space:nowrap;
}
.review-table thead th{
  background:var(--blue-100); color:var(--blue-800);
  font-size:18px !important; line-height:1.3; font-weight:700;
}
.review-table tr:hover{ background:#f8fbff }

/* æ¬„ä½é…ç½® */
.review-table thead th:first-child,
.review-table tbody td:first-child{
  width:56% !important; text-align:left !important;
}
.review-table thead th:nth-child(2),
.review-table thead th:nth-child(3),
.review-table tbody td:nth-child(2),
.review-table tbody td:nth-child(3){
  width:22% !important; text-align:center !important;
}

.tag-ok{ color:var(--green-500); font-weight:800 }
.tag-bad{ color:var(--red-500); font-weight:800 }

/* è¡Œå‹•æŒ‰éˆ•ï¼šå›ºå®šå­—ç´š 18pxï¼›æ‰‹æ©Ÿä¸€è¡Œä¸€é¡† */
.actions{
  margin-top:14px; display:flex; flex-direction:column; gap:10px; align-items:center; justify-content:center
}
.actions .btn-secondary,
.actions .btn-tertiary{
  font-size:18px !important; line-height:1.2;
}
@media (min-width:720px){
  .actions{ flex-direction:row }
}

/* ç‰ˆæ¬Šåœ¨åº•éƒ¨ */
.site-footer{ text-align:center; color:#6b7280; font-size:14px; padding:16px 12px; margin-top:auto }


</style>

</head>
<body>
<div class="wrap">
  <!-- Top Nav -->
  <nav>
    <button id="btnLearning" class="pill pill-purple active">ğŸ“š å­¸ç¿’ä¹˜æ³•</button>
    <button id="btnPractice" class="pill pill-green">ğŸ“ ç·´ç¿’æŒ‘æˆ°</button>
  </nav>

  <main>
    <!-- Learning Page -->
    <section id="learningPage" class="card">
      <h1 class="title">ååä¹˜æ³•è¡¨ ğŸ’–</h1>
      <div class="table-wrap">
        <table id="mulTable" class="mul" aria-label="10Ã—10 ä¹˜æ³•è¡¨"></table>
      </div>
      <p class="subtitle">é€™å€‹è¡¨æ ¼å¯ä»¥å¹«åŠ©ä½ å¿«é€Ÿå­¸ç¿’ä¹˜æ³•ï¼</p>
    </section>

    <!-- Practice Page -->
    <section id="practicePage" class="card" style="display:none">
      <div id="practiceContainer" class="center"></div>
    </section>
  </main>
  <footer class="site-footer">Â© 2025 Christina Yu. All rights reserved.</footer>

</div>

<script>
(function(){
  // ----- State -----
  const state = {
    currentPage: 'learning',
    selectedMultiplier: null, // number or 'all'
    currentQuestionIndex: 0,  // 0..9
    currentQuestion: null,    // {factor1, factor2, answer}
    options: [],
    score: 0,
    roundStarted: false,
    showResult: false,
    selectedAnswer: null,
    isCorrect: null,
    history: []
  };

  // ----- Audio via Tone.js -----
  let synth = null;

  async function initializeAudioContext(){
    if (Tone.context.state !== 'running') {
      await Tone.start();
      // create synth after user gesture
      if (!synth) synth = new Tone.Synth().toDestination();
      console.log('AudioContext is initialized and running!');
    } else {
      if (!synth) synth = new Tone.Synth().toDestination();
    }
  }

  const delay = (ms) => new Promise(r => setTimeout(r, ms));

  async function playCorrectSound(){
    if (!synth || Tone.context.state !== 'running') return;
    synth.triggerAttackRelease("C5","8n");
    await delay(100);
    synth.triggerAttackRelease("G5","8n");
    await delay(200);
    synth.triggerAttackRelease("C5","8n");
    await delay(100);
    synth.triggerAttackRelease("G5","8n");
  }
  async function playIncorrectSound(){
    if (!synth || Tone.context.state !== 'running') return;
    synth.triggerAttackRelease("F4","8n");
    await delay(250);
    synth.triggerAttackRelease("C4","8n");
  }

  // ----- Page Switch -----
  const btnLearning = document.getElementById('btnLearning');
  const btnPractice = document.getElementById('btnPractice');
  const learningPage = document.getElementById('learningPage');
  const practicePage = document.getElementById('practicePage');

  btnLearning.addEventListener('click', async () => {
    await initializeAudioContext(); // optional: warm up on nav click
    state.currentPage = 'learning';
    learningPage.style.display = '';
    practicePage.style.display = 'none';
    btnLearning.classList.add('active');
    btnPractice.classList.remove('active');
  });

  btnPractice.addEventListener('click', async () => {
    await initializeAudioContext();
    state.currentPage = 'practice';
    learningPage.style.display = 'none';
    practicePage.style.display = '';
    btnPractice.classList.add('active');
    btnLearning.classList.remove('active');
    renderPracticeSelect();
  });

  // ----- Build Learning Table (10Ã—10) -----
  function buildMulTable(){
    const t = document.getElementById('mulTable');
    t.innerHTML = '';
    const thead = document.createElement('thead');
    const trh = document.createElement('tr');

    const thx = document.createElement('th');
    thx.textContent = 'Ã—';
    trh.appendChild(thx);

    for(let c=1;c<=10;c++){
      const th = document.createElement('th');
      th.textContent = c;
      trh.appendChild(th);
    }
    thead.appendChild(trh);
    t.appendChild(thead);

    const tbody = document.createElement('tbody');

    for(let r=1;r<=10;r++){
      const tr = document.createElement('tr');

      const thRow = document.createElement('td');
      thRow.textContent = r;
      thRow.style.fontWeight = '800';
      tr.appendChild(thRow);

      for(let c=1;c<=10;c++){
        const td = document.createElement('td');
        td.textContent = r*c;

        td.addEventListener('mouseenter', () => highlightRC(r,c));
        td.addEventListener('mouseleave', () => clearHighlight());

        tr.appendChild(td);
      }
      tbody.appendChild(tr);
    }
    t.appendChild(tbody);
  }

  function highlightRC(r,c){
    const t = document.getElementById('mulTable');
    clearHighlight();

    // header col
    t.tHead.rows[0].cells[c].classList.add('hl-strong');

    // rows
    for(let ri=0; ri<t.tBodies[0].rows.length; ri++){
      const row = t.tBodies[0].rows[ri];
      const rowIndex = ri+1;

      // row label cell
      if (rowIndex === r) row.cells[0].classList.add('hl-strong'); else row.cells[0].classList.remove('hl-strong');

      for(let ci=1; ci<row.cells.length; ci++){
        const cell = row.cells[ci];
        if (rowIndex === r || ci === c) {
          cell.classList.add('hl');
        }
        if (rowIndex === r && ci === c) {
          cell.classList.remove('hl');
          cell.classList.add('hl-strong');
        }
      }
    }
  }

  function clearHighlight(){
    document.querySelectorAll('#mulTable .hl, #mulTable .hl-strong').forEach(el => el.classList.remove('hl','hl-strong'));
  }

  // ----- Practice Flow -----
  const practiceContainer = document.getElementById('practiceContainer');

  function renderPracticeSelect(){
    state.roundStarted = false;
    state.showResult = false;
    practiceContainer.innerHTML = `
      <h1 class="title" style="color:#16a34a; text-shadow:0 3px 0 rgba(255,255,255,.4); margin-bottom:18px">ä¹˜æ³•å¤§æŒ‘æˆ° ğŸŒŸ</h1>

      <div class="grid grid-multipliers mb-6" id="multiGrid">
        <button class="btn btn-multi" data-val="all" style="grid-column:1/-1; font-size:clamp(22px,4vw,34px); padding:18px 0; border-radius:18px; background:#c7d2fe; color:#1e3a8a; box-shadow:0 8px 22px rgba(30,58,138,.25)">ğŸ² ç¶œåˆç·´ç¿’ (1~10)</button>
        ${Array.from({length:10},(_,i)=>i+1).map(n=>`<button class="btn btn-multi" data-val="${n}">${n}x</button>`).join('')}
      </div>

      <button id="btnStart" class="btn-start" disabled>é–‹å§‹ç·´ç¿’ï¼ğŸš€</button>
    `;

    const g = document.getElementById('multiGrid');
    const startBtn = document.getElementById('btnStart');

    g.addEventListener('click', (e)=>{
      const b = e.target.closest('button[data-val]');
      if (!b) return;
      g.querySelectorAll('button').forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      const val = b.getAttribute('data-val');
      state.selectedMultiplier = (val==='all') ? 'all' : Number(val);
      startBtn.disabled = false;
    });

    startBtn.addEventListener('click', async ()=>{
      await initializeAudioContext();
      startRound();
      renderQuiz();
    });
  }

  function startRound(){
    state.score = 0;
    state.currentQuestionIndex = 0;
    state.roundStarted = true;
    state.showResult = false;
    state.history = [];
    generateQuestion(state.selectedMultiplier);
  }

  function generateQuestion(multiplier){
    let factor1, factor2;
    if (multiplier === 'all'){
      factor1 = Math.floor(Math.random()*10)+1;
      factor2 = Math.floor(Math.random()*10)+1;
    } else {
      factor1 = multiplier;
      factor2 = Math.floor(Math.random()*10)+1;
    }
    const answer = factor1 * factor2;

    const set = new Set([answer]);
    while(set.size < 4){
      const wrong = answer + (Math.floor(Math.random()*20) - 10);
      if (wrong > 0 && wrong !== answer) set.add(wrong);
    }
    const options = Array.from(set).sort(()=>Math.random()-0.5);

    state.currentQuestion = {factor1, factor2, answer};
    state.options = options;
    state.selectedAnswer = null;
    state.isCorrect = null;
  }

  function renderQuiz(){
    const title = (state.selectedMultiplier === 'all') ? 'ç¶œåˆä¹˜æ³•ç·´ç¿’ âœ¨' : `${state.selectedMultiplier} çš„ä¹˜æ³•ç·´ç¿’ âœ¨`;
    practiceContainer.innerHTML = `
      <h1 class="title" style="color:#9333ea; margin-bottom:10px">${title}</h1>
      <div class="score">å¾—åˆ†ï¼š<span>${state.score}</span> / 100</div>
      <div class="qcount">é¡Œç›® ${state.currentQuestionIndex+1} / 10</div>

      <div class="question-box">
        <p class="question">${state.currentQuestion.factor1} Ã— ${state.currentQuestion.factor2} = ?</p>
      </div>

      <div class="grid grid-choices mb-6" id="choices">
        ${state.options.map(v=>`<button class="btn btn-choice" data-val="${v}">${v}</button>`).join('')}
      </div>

      <p id="feedback" class="feedback" style="display:none"></p>
    `;

    const choices = document.getElementById('choices');
    const feedback = document.getElementById('feedback');

    choices.addEventListener('click', async (e)=>{
      const btn = e.target.closest('button[data-val]');
      if (!btn) return;
      if (state.selectedAnswer !== null) return; // already answered

      const selected = Number(btn.getAttribute('data-val'));
      state.selectedAnswer = selected;
      const correct = (selected === state.currentQuestion.answer);
      state.isCorrect = correct;

      // visual states
      const allBtns = [...choices.querySelectorAll('button[data-val]')];
      allBtns.forEach(b=>{
        const val = Number(b.getAttribute('data-val'));
        if (val === state.currentQuestion.answer){
          b.classList.add('correct'); // always show correct in GREEN
        } else if (val === selected && !correct){
          b.classList.add('wrong');
        } else {
          b.classList.add('dim');
        }
        b.disabled = true;
      });

      // sound + score + feedback
      if (correct){
        state.score += 10;
        feedback.textContent = 'âœ… ç­”å°äº†ï¼';
        await playCorrectSound();
      } else {
        feedback.textContent = `âŒ ç­”éŒ¯äº†ï¼Œæ­£ç¢ºç­”æ¡ˆæ˜¯ ${state.currentQuestion.answer}`;
        await playIncorrectSound();
      }
      feedback.style.display = '';

      // save history
      state.history.push({
        question: `${state.currentQuestion.factor1} Ã— ${state.currentQuestion.factor2}`,
        correctAnswer: state.currentQuestion.answer,
        userAnswer: selected,
        isCorrect: correct
      });

      // next step
      setTimeout(()=>{
        if (state.currentQuestionIndex < 9){
          state.currentQuestionIndex += 1;
          generateQuestion(state.selectedMultiplier);
          renderQuiz();
        } else {
          state.showResult = true;
          renderResult();
        }
      }, 1500);
    });
  }

  function renderResult(){
    practiceContainer.innerHTML = `
      <h1 class="result-title">ç·´ç¿’çµæŸï¼ğŸ‰</h1>
      <p style="text-align:center; font-size:clamp(20px,3.2vw,28px); margin:8px 0 12px">ä½ çš„æœ€çµ‚å¾—åˆ†æ˜¯ï¼š</p>
      <div class="center"><span class="score-badge">${state.score} åˆ†</span></div>

      <h2 class="title" style="color:#2563eb; margin-top:12px; margin-bottom:12px">é¡Œç›®å›é¡§</h2>
      <div class="review">
        <table class="review-table" aria-label="å›é¡§è¡¨">
          <thead>
            <tr>
              <th>é¡Œç›®</th>
              <th>ä½ çš„ç­”æ¡ˆ</th>
              <th>æ­£ç¢ºç­”æ¡ˆ</th>
            </tr>
          </thead>
          <tbody>
            ${state.history.map(h => `
              <tr>
                <td style="font-weight:800">${h.question}</td>
                <td class="${h.isCorrect ? 'tag-ok' : 'tag-bad'}">${h.userAnswer}</td>
                <td style="font-weight:800; color:#374151">${h.correctAnswer}</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      </div>

      <div class="actions">
        <button id="btnRestart" class="btn-secondary">é‡æ–°é¸æ“‡ç·´ç¿’ ğŸ”„</button>
        <button id="btnReplay" class="btn-tertiary">${state.selectedMultiplier==='all' ? 'å†ç©ä¸€æ¬¡ç¶œåˆç·´ç¿’ï¼ğŸ²' : `å†ç©ä¸€æ¬¡ ${state.selectedMultiplier} çš„ä¹˜æ³•ï¼âœ¨`}</button>
      </div>
    `;

    document.getElementById('btnRestart').addEventListener('click', ()=>{
      state.selectedMultiplier = null;
      renderPracticeSelect();
    });

    document.getElementById('btnReplay').addEventListener('click', async ()=>{
      await initializeAudioContext();
      startRound();
      renderQuiz();
    });
  }

  // ----- Init -----
  buildMulTable();
})();
</script>
</body>
</html>


















